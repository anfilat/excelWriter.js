/*
excelWriter - Javascript module for generating Excel files
<https://github.com/anfilat/excelWriter.js>
(c) 2017 Andrey Filatkin
Dual licenced under the MIT license or GPLv3
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.excelWriter=t()}}(function(){return function(){function t(e,n,i){function s(r,a){if(!n[r]){if(!e[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[r]={exports:{}};e[r][0].call(h.exports,function(t){return s(e[r][1][t]||t)},h,h.exports,t,e,n,i)}return n[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}return t}()({1:[function(t,e,n){},{}],2:[function(t,e,n){(function(n){"use strict";function i(t){var e="<"+t.name,n="";return t.ns&&(e=r.xmlPrefix+e+' xmlns="'+r.schemas[t.ns]+'"'),t.attributes&&t.attributes.forEach(function(t){var n=s(t,2),i=n[0],r=n[1];e+=" "+i+'="'+o.escape(r)+'"'}),void 0!==t.value&&(n+=o.escape(t.value)),t.children&&(n+=t.children.join("")),e+=n?">"+n+"</"+t.name+">":"/>"}var s=function(){function t(t,e){var n=[],i=!0,s=!1,o=void 0;try{for(var r,a=t[Symbol.iterator]();!(i=(r=a.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){s=!0,o=t}finally{try{!i&&a.return&&a.return()}finally{if(s)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o="undefined"!=typeof window?window._:void 0!==n?n._:null,r=t("./util");e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./util":29}],3:[function(t,e,n){"use strict";function i(t){this.common=t,this.images=Object.create(null),this.imageByNames=Object.create(null),this.extensions=Object.create(null)}function s(t){switch(t.toLowerCase()){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"gif":return"image/gif";default:return null}}i.prototype={add:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments[2],i=this.images[t];if(i)n&&!this.imageByNames[n]&&(i.name=n,this.imageByNames[n]=i);else{var o=this.common.uniqueIdForSpace("image"),r="xl/media/image"+o+"."+e,a=s(e);n=n||"excelWriter"+o,i={objectId:"image"+o,data:t,name:n,contentType:a,extension:e,path:r},this.common.addPath(i,"/"+r),this.images[t]=i,this.imageByNames[n]=i,this.extensions[e]=a}return i.name},get:function(t){return this.imageByNames[t]},getImages:function(){return this.images},removeImages:function(){this.images=null,this.imageByNames=null},getExtensions:function(){return this.extensions}},e.exports=i},{}],4:[function(t,e,n){"use strict";function i(){this.idSpaces=Object.create(null),this.paths=Object.create(null),this.images=new s(this),this.strings=new o(this),this.addPath(this.strings,"sharedStrings.xml"),this.styles=new r(this),this.addPath(this.styles,"styles.xml"),this.worksheets=[],this.tables=[],this.drawings=[]}var s=t("./images"),o=t("./sharedStrings"),r=t("../styles");i.prototype={uniqueId:function(t){return t+this.uniqueIdForSpace(t)},uniqueIdForSpace:function(t){return this.idSpaces[t]||(this.idSpaces[t]=1),this.idSpaces[t]++},addPath:function(t,e){this.paths[t.objectId]=e},getPath:function(t){return this.paths[t.objectId]},addWorksheet:function(t){var e=this.worksheets.length+1,n="worksheets/sheet"+e+".xml",i="xl/worksheets/_rels/sheet"+e+".xml.rels";t.path="xl/"+n,t.relationsPath=i,this.worksheets.push(t),this.addPath(t,n)},getNewWorksheetDefaultName:function(){return"Sheet "+(this.worksheets.length+1)},setActiveWorksheet:function(t){this.activeWorksheet=t},getActiveWorksheetIndex:function(){if(this.activeWorksheet){var t=this.activeWorksheet.objectId;return Math.max(0,this.worksheets.findIndex(function(e){return e.objectId===t}))}return 0},addTable:function(t){var e=this.tables.length+1,n="xl/tables/table"+e+".xml";t.path=n,this.tables.push(t),this.addPath(t,"/"+n)},addDrawings:function(t){var e=this.drawings.length+1,n="xl/drawings/drawing"+e+".xml",i="xl/drawings/_rels/drawing"+e+".xml.rels";t.path=n,t.relationsPath=i,this.drawings.push(t),this.addPath(t,"/"+n)}},e.exports=i},{"../styles":19,"./images":3,"./sharedStrings":5}],5:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t){this.objectId=t.uniqueId("SharedStrings"),this.strings=Object.create(null),this.stringArray=[],this.count=0}function a(t){return f.xmlPrefix+'<sst xmlns="'+f.schemas.spreadsheetml+'" count="'+t+'" uniqueCount="'+t+'">'}var l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=t("stream").Readable,h="undefined"!=typeof window?window._:void 0!==n?n._:null,f=t("../util"),d=/^\s|\s$/;r.prototype={add:function(t){var e=this.strings[t];return void 0===e&&(e=this.count++,this.strings[t]=e,this.stringArray[e]=t),e},isStrings:function(){return this.count>0},save:function(){var t=!!u;if(this.strings=null,t)return new c({strings:this.stringArray});var e=a(this.count)+this.stringArray.map(function(t){return t=h.escape(t),d.test(t)?'<si><t xml:space="preserve">'+t+"</t></si>":"<si><t>"+t+"</t></si>"}).join("")+"</sst>";return this.stringArray=null,e}};var c=function(t){function e(t){i(this,e);var n=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.strings=t.strings,n.status=0,n.index=0,n.len=n.strings.length,n}return o(e,t),l(e,[{key:"_read",value:function(t){var e=!1;if(0===this.status&&(e=!this.push(a(this.len)),this.status=1),1===this.status){for(;this.index<this.len&&!e;)e=!this.push(this.packChunk(t));this.index===this.len&&(this.status=2)}2===this.status&&(this.push("</sst>"),this.push(null))}},{key:"packChunk",value:function(t){for(var e="";this.index<this.len&&e.length<t;){var n=h.escape(this.strings[this.index]);d.test(n)?e+='<si><t xml:space="preserve">'+n+"</t></si>":e+="<si><t>"+n+"</t></si>",this.strings[this.index]=null,this.index++}return e}}]),e}(u||null);e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util":29,stream:1}],6:[function(t,e,n){"use strict";var i={dashDot:"dashDot",dashDotDot:"dashDotDot",dashed:"dashed",dotted:"dotted",double:"double",hair:"hair",medium:"medium",mediumDashDot:"mediumDashDot",mediumDashDotDot:"mediumDashDotDot",mediumDashed:"mediumDashed",none:"none",slantDashDot:"slantDashDot",thick:"thick",thin:"thin"};e.exports={borderStyle:i}},{}],7:[function(t,e,n){(function(n){"use strict";function i(t){var e=void 0;s.isObject(t)?e=s.has(t,"cell")?s.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:o.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(e=o.letterToPosition(t||""),t={});var n=e.x-1,i=e.y-1;this.from={x:n,y:i,xOff:o.pixelsToEMUs(t.left||0),yOff:o.pixelsToEMUs(t.top||0)},this.to={x:n+(t.cols||1),y:i+(t.rows||1),xOff:o.pixelsToEMUs(-t.right||0),yOff:o.pixelsToEMUs(-t.bottom||0)}}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../util"),r=t("../XMLString");i.prototype={saveWithContent:function(t){return r({name:"xdr:twoCellAnchor",children:[r({name:"xdr:from",children:[r({name:"xdr:col",value:this.from.x}),r({name:"xdr:colOff",value:this.from.xOff}),r({name:"xdr:row",value:this.from.y}),r({name:"xdr:rowOff",value:this.from.yOff})]}),r({name:"xdr:to",children:[r({name:"xdr:col",value:this.to.x}),r({name:"xdr:colOff",value:this.to.xOff}),r({name:"xdr:row",value:this.to.y}),r({name:"xdr:rowOff",value:this.to.yOff})]}),t,r({name:"xdr:clientData"})]})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29}],8:[function(t,e,n){"use strict";function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.left,n=void 0===e?0:e,i=t.top,o=void 0===i?0:i,r=t.width,a=void 0===r?0:r,l=t.height,u=void 0===l?0:l;this.x=s.pixelsToEMUs(n),this.y=s.pixelsToEMUs(o),this.width=s.pixelsToEMUs(a),this.height=s.pixelsToEMUs(u)}var s=t("../util"),o=t("../XMLString");i.prototype={saveWithContent:function(t){return o({name:"xdr:absoluteAnchor",children:[o({name:"xdr:pos",attributes:[["x",this.x],["y",this.y]]}),o({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),t,o({name:"xdr:clientData"})]})}},e.exports=i},{"../XMLString":2,"../util":29}],9:[function(t,e,n){(function(n){"use strict";function i(t){var e=void 0;s.isObject(t)?e=s.has(t,"cell")?s.isObject(t.cell)?{x:t.cell.c||1,y:t.cell.r||1}:o.letterToPosition(t.cell||""):{x:t.c||1,y:t.r||1}:(e=o.letterToPosition(t||""),t={}),this.x=e.x-1,this.y=e.y-1,this.xOff=o.pixelsToEMUs(t.left||0),this.yOff=o.pixelsToEMUs(t.top||0),this.width=o.pixelsToEMUs(t.width||0),this.height=o.pixelsToEMUs(t.height||0)}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../util"),r=t("../XMLString");i.prototype={saveWithContent:function(t){return r({name:"xdr:oneCellAnchor",children:[r({name:"xdr:from",children:[r({name:"xdr:col",value:this.x}),r({name:"xdr:colOff",value:this.xOff}),r({name:"xdr:row",value:this.y}),r({name:"xdr:rowOff",value:this.yOff})]}),r({name:"xdr:ext",attributes:[["cx",this.width],["cy",this.height]]}),t,r({name:"xdr:clientData"})]})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29}],10:[function(t,e,n){"use strict";function i(t){this.common=t,this.objectId=this.common.uniqueId("Drawings"),this.drawings=[],this.relations=new s(t)}var s=t("../relations"),o=t("../util"),r=t("../XMLString"),a=t("./picture");i.prototype={add:function(t,e,n){var i=this.common.images.get(t),s=this.relations.add(i,"image"),o=new a(this.common,{image:i,imageRelationId:s,config:e,anchorType:n});this.drawings.push(o)},save:function(){var t=[["xmlns:a",o.schemas.drawing],["xmlns:r",o.schemas.relationships],["xmlns:xdr",o.schemas.spreadsheetDrawing]],e=this.drawings.map(function(t){return t.save()});return r({name:"xdr:wsDr",ns:"spreadsheetDrawing",attributes:t,children:e})}},e.exports=i},{"../XMLString":2,"../relations":13,"../util":29,"./picture":11}],11:[function(t,e,n){"use strict";function i(t,e){this.pictureId=t.uniqueIdForSpace("Picture"),this.image=e.image,this.imageRelationId=e.imageRelationId,this.createAnchor(e.anchorType,e.config)}var s=t("../util"),o=t("../XMLString"),r=t("./anchor"),a=t("./anchorOneCell"),l=t("./anchorAbsolute");i.prototype={createAnchor:function(t,e){switch(t){case"anchor":this.anchor=new r(e);break;case"oneCell":this.anchor=new a(e);break;case"absolute":this.anchor=new l(e)}},save:function(){return this.anchor.saveWithContent(o({name:"xdr:pic",children:[o({name:"xdr:nvPicPr",children:[o({name:"xdr:cNvPr",attributes:[["id",this.pictureId],["name",this.image.name]]}),o({name:"xdr:cNvPicPr",children:[o({name:"a:picLocks",attributes:[["noChangeAspect","1"],["noChangeArrowheads","1"]]})]})]}),o({name:"xdr:blipFill",children:[o({name:"a:blip",attributes:[["xmlns:r",s.schemas.relationships],["r:embed",this.imageRelationId]]}),o({name:"a:srcRect"}),o({name:"a:stretch",children:[o({name:"a:fillRect"})]})]}),o({name:"xdr:spPr",attributes:[["bwMode","auto"]],children:[o({name:"a:xfrm"}),o({name:"a:prstGeom",attributes:[["prst","rect"]]})]})]}))}},e.exports=i},{"../XMLString":2,"../util":29,"./anchor":7,"./anchorAbsolute":8,"./anchorOneCell":9}],12:[function(t,e,n){"use strict";function i(){var t={addWorksheet:function(t){return e.addWorksheet(t)},addFormat:function(t,e){return n.addFormat(t,e)},addFontFormat:function(t,e){return n.addFontFormat(t,e)},addBorderFormat:function(t,e){return n.addBorderFormat(t,e)},addPatternFormat:function(t,e){return n.addPatternFormat(t,e)},addGradientFormat:function(t,e){return n.addGradientFormat(t,e)},addNumberFormat:function(t,e){return n.addNumberFormat(t,e)},addTableFormat:function(t,e){return n.addTableFormat(t,e)},addTableElementFormat:function(t,e){return n.addTableElementFormat(t,e)},setDefaultTableStyle:function(t){return n.setDefaultTableStyle(t),this},addImage:function(t,e,n){return i.add(t,e,n)},save:function(t){return e.save(t)},saveAsNodeStream:function(t){return e.saveAsNodeStream(t)}},e=new s(t),n=e.styles,i=e.images;return t}var s=t("./workbook"),o=t("./constants");e.exports=o,e.exports.createWorkbook=i},{"./constants":6,"./workbook":30}],13:[function(t,e,n){(function(n){"use strict";function i(t){this.common=t,this.relations=Object.create(null),this.lastId=1}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./util"),r=t("./XMLString");i.prototype={add:function(t,e){var n=this.relations[t.objectId];if(n)return n.relationId;var i="rId"+this.lastId++;return this.relations[t.objectId]={relationId:i,schema:o.schemas[e],object:t},i},getId:function(t){var e=this.relations[t.objectId];return e?e.relationId:null},save:function(){var t=this,e=s.map(this.relations,function(e){var n=[["Id",e.relationId],["Type",e.schema],["Target",e.object.target||t.common.getPath(e.object)]];return e.object.targetMode&&n.push(["TargetMode",e.object.targetMode]),r({name:"Relationship",attributes:n})});return r({name:"Relationships",ns:"relationshipPackage",children:e})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./util":29}],14:[function(t,e,n){(function(n){"use strict";function i(t){var e={};return r.has(t,"horizontal")&&r.includes(l,t.horizontal)&&(e.horizontal=t.horizontal),r.has(t,"vertical")&&r.includes(u,t.vertical)&&(e.vertical=t.vertical),r.has(t,"indent")&&(e.indent=t.indent),r.has(t,"justifyLastLine")&&(e.justifyLastLine=t.justifyLastLine?1:0),r.has(t,"readingOrder")&&r.includes([0,1,2],t.readingOrder)&&(e.readingOrder=t.readingOrder),r.has(t,"relativeIndent")&&(e.relativeIndent=t.relativeIndent),r.has(t,"shrinkToFit")&&(e.shrinkToFit=t.shrinkToFit?1:0),r.has(t,"textRotation")&&(e.textRotation=t.textRotation),r.has(t,"wrapText")&&(e.wrapText=t.wrapText?1:0),r.isEmpty(e)?null:e}function s(t,e){return r.assign(t,e)}function o(t){return a({name:"alignment",attributes:r.toPairs(t)})}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,a=t("../XMLString"),l=["left","center","right","fill","justify","centerContinuous","distributed"],u=["top","center","bottom","justify","distributed"];e.exports={canon:i,merge:s,saveFormat:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],15:[function(t,e,n){(function(n){"use strict";function i(t){a.call(this,t,"borders","border"),this.init(),this.lastId=this.formats.length}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../constants"),r=o.borderStyle,a=t("./stylePart"),l=t("./utils"),u=l.saveColor,h=t("../XMLString"),f=["left","right","top","bottom"],d=["left","right","top","bottom","diagonal"];i.canon=function(t){var e={};return s.has(t,"style")||s.has(t,"color")?t.style&&!r[t.style]||f.forEach(function(n){e[n]={style:t.style,color:t.color}}):d.forEach(function(n){var i=t[n];!i||t.style&&!r[i.style]?e[n]={}:e[n]={style:i.style,color:i.color}}),e},i.saveFormat=function(t){var e=d.map(function(e){var n=t[e],i=void 0,s=void 0;return n&&(n.style&&(i=[["style",n.style]]),n.color&&(s=[u(n.color)])),h({name:e,attributes:i,children:s})});return h({name:"border",children:e})},i.prototype=s.merge({},a.prototype,{init:function(){this.formats.push({format:this.canon({})})},canon:i.canon,saveFormat:i.saveFormat,merge:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.canon({}),e=arguments[1];return e&&d.forEach(function(n){var i=e[n];i&&i.style&&(t[n].style=i.style),i&&i.color&&(t[n].color=i.color)}),t}}),e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../constants":6,"./stylePart":23,"./utils":26}],16:[function(t,e,n){(function(n){"use strict";function i(t){o.call(this,t,"cellXfs","format"),this.init(),this.lastId=this.formats.length,this.saveEmpty=!1}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./stylePart"),r=t("./alignment"),a=t("./protection"),l=t("./predeinedFormats"),u=t("../XMLString"),h=["format","fill","border","font"],f=["numFmtId","fillId","borderId","fontId"];i.prototype=s.merge({},o.prototype,{init:function(){var t=this;this.formats.push({format:this.canon({})}),s.keys(l).forEach(function(e){t.predefined[e]={format:e}})},canon:function(t,e){var n={};t.format&&(n.format=this.styles.numberFormats.add(t.format)),t.font&&(n.font=this.styles.fonts.add(t.font)),t.pattern?n.fill=this.styles.fills.add(t.pattern,null,{fillType:"pattern"}):t.gradient?n.fill=this.styles.fills.add(t.gradient,null,{fillType:"gradient"}):e&&e.merge&&t.fill&&(n.fill=this.styles.fills.add(t.fill,null,e)),t.border&&(n.border=this.styles.borders.add(t.border));var i=e&&e.merge?r.canon(t.alignment):r.canon(t);i&&(n.alignment=i);var s=e&&e.merge?a.canon(t.protection):a.canon(t);return s&&(n.protection=s),t.fillOut&&(n.fillOut=t.fillOut),n},fullGet:function(t){t=this.getId(t)?this.get(t):this.canon(t);var e={};return t.format&&(e.format=this.styles.numberFormats.get(t.format)),t.font&&(e.font=s.clone(this.styles.fonts.get(t.font))),t.fill&&(e.fill=s.clone(this.styles.fills.get(t.fill))),t.border&&(e.border=s.clone(this.styles.borders.get(t.border))),t.alignment&&(e.alignment=s.clone(t.alignment)),t.protection&&(e.protection=s.clone(t.protection)),e},cutVisible:function(t){var e={};return t.format&&(e.format=t.format),t.font&&(e.font=t.font),t.alignment&&(e.alignment=t.alignment),t.protection&&(e.protection=t.protection),e},merge:function(t,e){return(t.format||e.format)&&(t.format=this.styles.numberFormats.merge(t.format,e.format)),(t.font||e.font)&&(t.font=this.styles.fonts.merge(t.font,e.font)),(t.fill||e.fill)&&(t.fill=this.styles.fills.merge(t.fill,e.fill)),(t.border||e.border)&&(t.border=this.styles.borders.merge(t.border,e.border)),(t.alignment||e.alignment)&&(t.alignment=r.merge(t.alignment,e.alignment)),(t.protection||e.protection)&&(t.protection=a.merge(t.protection,e.protection)),t},saveFormat:function(t){var e=this.styles,n=[],i=[];return t.alignment&&(i.push(r.saveFormat(t.alignment)),n.push(["applyAlignment","true"])),t.protection&&(i.push(a.saveFormat(t.protection)),n.push(["applyProtection","true"])),s.forEach(t,function(t,i){if(s.includes(h,i)){var o=f[s.indexOf(h,i)];"format"===i?(n.push([o,e.numberFormats.getId(t)]),n.push(["applyNumberFormat","true"])):"fill"===i?(n.push([o,e.fills.getId(t)]),n.push(["applyFill","true"])):"border"===i?(n.push([o,e.borders.getId(t)]),n.push(["applyBorder","true"])):"font"===i&&(n.push([o,e.fonts.getId(t)]),n.push(["applyFont","true"]))}}),u({name:"xf",attributes:n,children:i})}}),e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./alignment":14,"./predeinedFormats":21,"./protection":22,"./stylePart":23}],17:[function(t,e,n){(function(n){"use strict";function i(t){a.call(this,t,"fills","fill"),this.init(),this.lastId=this.formats.length}function s(t){var e=[["patternType",t.patternType]],n=[d({name:"fgColor",attributes:[["rgb",u(t.fgColor)]]}),d({name:"bgColor",attributes:[["rgb",u(t.bgColor)]]})];return d({name:"patternFill",attributes:e,children:n})}function o(t){var e=[];t.degree?e.push(["degree",t.degree]):t.left&&(e.push(["type","path"]),e.push(["left",t.left]),e.push(["right",t.right]),e.push(["top",t.top]),e.push(["bottom",t.bottom]));var n=[d({name:"stop",attributes:[["position",0]],children:[f(t.start)]}),d({name:"stop",attributes:[["position",1]],children:[f(t.end)]})];return d({name:"gradientFill",attributes:e,children:n})}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,a=t("./stylePart"),l=t("../util"),u=l.canonColor,h=t("./utils"),f=h.saveColor,d=t("../XMLString"),c=["none","solid","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis"];i.canon=function(t,e){var n={fillType:e.merge?t.fillType:e.fillType};if("pattern"===n.fillType){var i=(e.merge?t.fgColor:t.color)||"FFFFFFFF",s=(e.merge?t.bgColor:t.backColor)||"FFFFFFFF",o=e.merge?t.patternType:t.type;n.patternType=r.includes(c,o)?o:"solid",e.isTable&&"solid"===n.patternType?(n.fgColor=s,n.bgColor=i):(n.fgColor=i,n.bgColor=s)}else r.has(t,"left")?(n.left=t.left||0,n.right=t.right||0,n.top=t.top||0,n.bottom=t.bottom||0):n.degree=t.degree||0,n.start=t.start||"FFFFFFFF",n.end=t.end||"FFFFFFFF";return n},i.saveFormat=function(t){var e="pattern"===t.fillType?[s(t)]:[o(t)];return d({name:"fill",children:e})},i.prototype=r.merge({},a.prototype,{init:function(){this.formats.push({format:this.canon({type:"none"},{fillType:"pattern"})},{format:this.canon({type:"gray125"},{fillType:"pattern"})})},canon:i.canon,saveFormat:i.saveFormat,merge:function(t,e){return e||t}}),e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29,"./stylePart":23,"./utils":26}],18:[function(t,e,n){(function(n){"use strict";function i(t){o.call(this,t,"fonts","font"),this.init(),this.lastId=this.formats.length}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./stylePart"),r=t("./utils"),a=r.saveColor,l=t("../XMLString");i.canon=function(t){var e={};return s.has(t,"bold")&&(e.bold=!!t.bold),s.has(t,"italic")&&(e.italic=!!t.italic),t.superscript&&(e.vertAlign="superscript"),t.subscript&&(e.vertAlign="subscript"),t.underline&&(-1!==s.indexOf(["double","singleAccounting","doubleAccounting"],t.underline)?e.underline=t.underline:e.underline=!0),s.has(t,"strike")&&(e.strike=!!t.strike),t.outline&&(e.outline=!0),t.shadow&&(e.shadow=!0),t.size&&(e.size=t.size),t.color&&(e.color=t.color),t.fontName&&(e.fontName=t.fontName),e},i.saveFormat=function(t){var e=[];if(t.size&&e.push(l({name:"sz",attributes:[["val",t.size]]})),t.fontName&&e.push(l({name:"name",attributes:[["val",t.fontName]]})),s.has(t,"bold")&&(t.bold?e.push(l({name:"b"})):e.push(l({name:"b",attributes:[["val",0]]}))),s.has(t,"italic")&&(t.italic?e.push(l({name:"i"})):e.push(l({name:"i",attributes:[["val",0]]}))),t.vertAlign&&e.push(l({name:"vertAlign",attributes:[["val",t.vertAlign]]})),t.underline){var n=null;!0!==t.underline&&(n=[["val",t.underline]]),e.push(l({name:"u",attributes:n}))}return s.has(t,"strike")&&(t.strike?e.push(l({name:"strike"})):e.push(l({name:"strike",attributes:[["val",0]]}))),t.shadow&&e.push(l({name:"shadow"})),t.outline&&e.push(l({name:"outline"})),t.color&&e.push(a(t.color)),l({name:"font",children:e})},i.prototype=s.merge({},o.prototype,{init:function(){this.formats.push({format:this.canon({})})},canon:i.canon,saveFormat:i.saveFormat,merge:function(t,e){var n=s.assign(t,e);return n.color=e&&e.color||t&&t.color,n}}),e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":23,"./utils":26}],19:[function(t,e,n){(function(n){"use strict";function i(t){this.objectId=t.uniqueId("Styles"),this.numberFormats=new o(this),this.fonts=new r(this),this.fills=new a(this),this.borders=new l(this),this.cells=new u(this),this.tableElements=new f(this),this.tables=new h(this),this.defaultTableStyle="",this.mergeCache=Object.create(null)}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./numberFormats"),r=t("./fonts"),a=t("./fills"),l=t("./borders"),u=t("./cells"),h=t("./tables"),f=t("./tableElements"),d=t("../XMLString");i.prototype={addFormat:function(t,e){return this.cells.add(t,e)},get:function(t){return this.cells.get(t)},getId:function(t){return this.cells.getId(t)},addFillOutFormat:function(t){if(this.get(t).fillOut)return t;var e=this.cells.cutVisible(this.cells.fullGet(t));return s.isEmpty(e)?void 0:this.addFormat(e)},merge:function(){for(var t=this,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];if(n=s.compact(n),0===n.length)return null;if(1===n.length)return this.addFormat(n[0]);var o=n.reduce(function(t,e){return t+JSON.stringify(e)},""),r=this.mergeCache[o];if(!r){var a={};n.forEach(function(e){a=t.cells.merge(a,t.cells.fullGet(e))}),r=this.cells.add(a,null,{merge:!0}),this.mergeCache[o]=r}return r},addFontFormat:function(t,e){return this.fonts.add(t,e)},addBorderFormat:function(t,e){return this.borders.add(t,e)},addPatternFormat:function(t,e){return this.fills.add(t,e,{fillType:"pattern"})},addGradientFormat:function(t,e){return this.fills.add(t,e,{fillType:"gradient"})},addNumberFormat:function(t,e){return this.numberFormats.add(t,e)},addTableFormat:function(t,e){return this.tables.add(t,e)},addTableElementFormat:function(t,e){return this.tableElements.add(t,e)},setDefaultTableStyle:function(t){this.tables.defaultTableStyle=t},save:function(){return d({name:"styleSheet",ns:"spreadsheetml",children:[this.numberFormats.save(),this.fonts.save(),this.fills.save(),this.borders.save(),this.cells.save(),this.tableElements.save(),this.tables.save()]})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./borders":15,"./cells":16,"./fills":17,"./fonts":18,"./numberFormats":20,"./tableElements":24,"./tables":25}],20:[function(t,e,n){(function(n){"use strict";function i(t){o.call(this,t,"numFmts","numberFormat"),this.init(),this.lastId=164}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./stylePart"),r=t("./predeinedFormats"),a=t("../XMLString");i.canon=function(t){return t},i.saveFormat=function(t,e){var n=[["numFmtId",e.formatId],["formatCode",t]];return a({name:"numFmt",attributes:n})},i.prototype=s.merge({},o.prototype,{init:function(){var t=this;s.forEach(r,function(e,n){t.formatsByNames[n]={formatId:e,format:n}})},canon:i.canon,saveFormat:i.saveFormat,merge:function(t,e){return e||t}}),e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./predeinedFormats":21,"./stylePart":23}],21:[function(t,e,n){"use strict";var i={date:14,time:21};e.exports=i},{}],22:[function(t,e,n){(function(n){"use strict";function i(t){var e={};return r.has(t,"locked")&&(e.locked=t.locked?1:0),r.has(t,"hidden")&&(e.hidden=t.hidden?1:0),r.isEmpty(e)?null:e}function s(t,e){return r.assign(t,e)}function o(t){return a({name:"protection",attributes:r.toPairs(t)})}var r="undefined"!=typeof window?window._:void 0!==n?n._:null,a=t("../XMLString");e.exports={canon:i,merge:s,saveFormat:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],23:[function(t,e,n){(function(n){"use strict";function i(t,e,n){this.styles=t,this.saveName=e,this.formatName=n,this.lastName=1,this.lastId=0,this.saveEmpty=!0,this.formats=[],this.formatsByData=Object.create(null),this.formatsByNames=Object.create(null),this.predefined={}}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../XMLString");i.prototype={init:function(){},add:function(t,e,n){if(e&&this.formatsByNames[e]){var i=this.canon(t,n),o=s.isObject(i)?JSON.stringify(i):i;return o!==this.formatsByNames[e].stringFormat&&this.addNew(i,o,e),e}if(!e&&s.isString(t)){if(this.formatsByNames[t])return t;if(this.predefined[t])return this.add(this.predefined[t],t)}var r=this.canon(t,n),a=s.isObject(r)?JSON.stringify(r):r,l=this.formatsByData[a];return l?e&&!this.formatsByNames[e]&&(l.name=e,this.formatsByNames[e]=l):l=this.addNew(r,a,e),l.name},addNew:function(t,e,n){n=n||this.formatName+this.lastName++;var i={name:n,formatId:this.lastId++,format:t,stringFormat:e};return this.formats.push(i),this.formatsByData[e]=i,this.formatsByNames[n]=i,i},canon:function(t){return t},get:function(t){if(s.isString(t)){var e=this.formatsByNames[t];return e?e.format:t}return t},getId:function(t){var e=this.formatsByNames[t];return e?e.formatId:this.getPredefinedId(t)},getPredefinedId:function(t){return this.predefined[t]?this.getId(this.add(this.predefined[t],t)):null},save:function(){var t=this;if(!1!==this.saveEmpty||this.formats.length){var e=[["count",this.formats.length]],n=this.formats.map(function(e){return t.saveFormat(e.format,e)});return this.saveCollectionExt(e,n),o({name:this.saveName,attributes:e,children:n})}return""},saveCollectionExt:function(){},saveFormat:function(){return""}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2}],24:[function(t,e,n){(function(n){"use strict";function i(t){o.call(this,t,"dxfs","tableElement")}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./stylePart"),r=t("./numberFormats"),a=t("./fonts"),l=t("./fills"),u=t("./borders"),h=t("./alignment"),f=t("../XMLString");i.prototype=s.merge({},o.prototype,{canon:function(t){var e={};return t.format&&(e.format=r.canon(t.format)),t.font&&(e.font=a.canon(t.font)),t.pattern?e.fill=l.canon(t.pattern,{fillType:"pattern",isTable:!0}):t.gradient&&(e.fill=l.canon(t.gradient,{fillType:"gradient"})),t.border&&(e.border=u.canon(t.border)),e.alignment=h.canon(t),e},saveFormat:function(t){var e=[];return t.font&&e.push(a.saveFormat(t.font)),t.fill&&e.push(l.saveFormat(t.fill)),t.border&&e.push(u.saveFormat(t.border)),t.format&&e.push(r.saveFormat(t.format)),t.alignment&&t.alignment.length&&e.push(h.save(t.alignment)),f({name:"dxf",children:e})}}),e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./alignment":14,"./borders":15,"./fills":17,"./fonts":18,"./numberFormats":20,"./stylePart":23}],25:[function(t,e,n){(function(n){"use strict";function i(t){o.call(this,t,"tableStyles","table"),this.saveEmpty=!1}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./stylePart"),r=t("../XMLString"),a=["wholeTable","headerRow","totalRow","firstColumn","lastColumn","firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe","firstHeaderCell","lastHeaderCell","firstTotalCell","lastTotalCell"],l=["firstRowStripe","secondRowStripe","firstColumnStripe","secondColumnStripe"];i.prototype=s.merge({},o.prototype,{canon:function(t){var e={},n=this.styles;return s.forEach(t,function(t,i){if(s.includes(a,i)){var o=void 0,r=null;t.style?(o=n.tableElements.add(t.style),t.size>1&&s.includes(l,i)&&(r=t.size)):o=n.tableElements.add(t),e[i]={style:o,size:r}}}),e},saveCollectionExt:function(t){this.styles.defaultTableStyle&&t.push(["defaultTableStyle",this.styles.defaultTableStyle])},saveFormat:function(t,e){var n=this.styles,i=[["name",e.name],["pivot",0]],o=[];return s.forEach(t,function(t,e){var i=t.style,s=t.size,a=[["type",e],["dxfId",n.tableElements.getId(i)]];s&&a.push(["size",s]),o.push(r({name:"tableStyleElement",attributes:a}))}),i.push(["count",o.length]),r({name:"tableStyle",attributes:i,children:o})}}),e.exports=i
}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"./stylePart":23}],26:[function(t,e,n){(function(n){"use strict";function i(t){if(s.isString(t))return a({name:"color",attributes:[["rgb",r(t)]]});var e=[];return s.isUndefined(t.tint)||e.push(["tint",t.tint]),s.isUndefined(t.auto)||e.push(["auto",!!t.auto]),s.isUndefined(t.theme)||e.push(["theme",t.theme]),a({name:"color",attributes:e})}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../util"),r=o.canonColor,a=t("../XMLString");e.exports={canonColor:r,saveColor:i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29}],27:[function(t,e,n){"use strict";function i(t,e,n){var i=new s(n,e);return{outerTable:{end:function(){return t},setReferenceRange:function(t,e){return i.setReferenceRange(t,e),this},addTotalRow:function(t){return i.addTotalRow(t),this},setTheme:function(t){return i.setTheme(t),this},setSortState:function(t){i.setSortState(t)}},table:i}}var s=t("./table");e.exports=i},{"./table":28}],28:[function(t,e,n){(function(n){"use strict";function i(t,e){this.common=e,this.tableId=this.common.uniqueIdForSpace("Table"),this.objectId="Table"+this.tableId,this.name=this.objectId,this.displayName=this.objectId,this.headerRowCount=1,this.beginCell=null,this.endCell=null,this.totalsRowCount=0,this.totalRow=null,this.themeStyle=null,o.extend(this,t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o="undefined"!=typeof window?window._:void 0!==n?n._:null,r=t("../util"),a=t("../XMLString"),l=["average","countNums","count","max","min","stdDev","sum","var"],u=[101,102,103,104,105,107,109,110];i.prototype={setReferenceRange:function(t,e){this.beginCell=r.canonCell(t),this.endCell=r.canonCell(e)},addTotalRow:function(t){this.totalRow=t,this.totalsRowCount=1},setTheme:function(t){this.themeStyle=t},setSortState:function(t){this.sortState=t},prepare:function(t){if(this.totalRow){var e=this.name,n=r.letterToPosition(this.beginCell),i=r.letterToPosition(this.endCell),a=n.y-1,h=n.x-1,f=i.y-1,d=t[a]||[],c=t[f+1];c||(c=[],t[f+1]=c),o.forEach(this.totalRow,function(t,n){var i=d[h+n],r=void 0;"object"===(void 0===i?"undefined":s(i))&&(i=i.value),t.name=i,t.totalsRowLabel?c[h+n]={value:t.totalsRowLabel,type:"string"}:t.totalsRowFunction&&-1!==(r=o.indexOf(l,t.totalsRowFunction))&&(c[h+n]={value:"SUBTOTAL("+u[r]+","+e+"["+i+"])",type:"formula"})})}},save:function(){var t=[["id",this.tableId],["name",this.name],["displayName",this.displayName]],e=[],n=r.letterToPosition(this.endCell),i=this.beginCell+":"+r.positionToLetter(n.x,n.y+this.totalsRowCount);return t.push(["ref",i]),t.push(["totalsRowCount",this.totalsRowCount]),t.push(["headerRowCount",this.headerRowCount]),e.push(this.saveAutoFilter()),e.push(this.saveTableColumns()),e.push(this.saveTableStyleInfo()),a({name:"table",ns:"spreadsheetml",attributes:t,children:e})},saveAutoFilter:function(){return a({name:"autoFilter",attributes:["ref",this.beginCell+":"+this.endCell]})},saveTableColumns:function(){var t=[["count",this.totalRow.length]],e=o.map(this.totalRow,function(t,e){var n=[["id",e+1],["name",t.name]];return t.totalsRowFunction&&n.push(["totalsRowFunction",t.totalsRowFunction]),t.totalsRowLabel&&n.push(["totalsRowLabel",t.totalsRowLabel]),a({name:"tableColumn",attributes:n})});return a({name:"tableColumns",attributes:t,children:e})},saveTableStyleInfo:function(){var t=[["name",this.themeStyle]],e=this.common.styles.tables.get(this.themeStyle),n=!1,i=!1,s=!1,o=!1;return e&&(n=e.firstRowStripe||e.secondRowStripe,i=e.firstColumnStripe||e.secondColumnStripe,s=e.firstColumn,o=e.lastColumn),t.push(["showRowStripes",n?"1":"0"],["showColumnStripes",i?"1":"0"],["showFirstColumn",s?"1":"0"],["showLastColumn",o?"1":"0"]),a({name:"tableStyleInfo",attributes:t})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29}],29:[function(t,e,n){(function(t){"use strict";function n(t,e){var n=u[t];if(!n){var i="",s=t,o=void 0;do{o=(s-1)%26,i=l[o]+i,s=(s-(o+1))/26}while(s>0);u[t]=i,n=i}return n+(e||"")}function i(t){for(var e=0,n=0,i=0,s=t.length;i<s;i++){var o=t.charCodeAt(i);if(!(o>=65)){n=parseInt(t.slice(i),10);break}e=26*e+o-64}return{x:e||1,y:n||1}}function s(t){return Math.round(914400*t/96)}function o(t){return a.isObject(t)?n(t.c||1,t.r||1):t}function r(t){return"#"===t[0]?"FF"+t.substr(1):t}var a="undefined"!=typeof window?window._:void 0!==t?t._:null,l="ABCDEFGHIJKLMNOPQRSTUVWXYZ",u={};e.exports={positionToLetter:n,letterToPosition:i,pixelsToEMUs:s,canonCell:o,canonColor:r,xmlPrefix:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n',schemas:{worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",sharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",stylesheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",relationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",relationshipPackage:"http://schemas.openxmlformats.org/package/2006/relationships",contentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",spreadsheetml:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",markupCompat:"http://schemas.openxmlformats.org/markup-compatibility/2006",x14ac:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",officeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",package:"http://schemas.openxmlformats.org/package/2006/relationships",table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",spreadsheetDrawing:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",drawing:"http://schemas.openxmlformats.org/drawingml/2006/main",drawingRelationship:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",chart:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink"}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],30:[function(t,e,n){(function(n){"use strict";function i(t){this.outerWorkbook=t,this.common=new a,this.styles=this.common.styles,this.images=this.common.images,this.relations=new l(this.common),this.relations.add(this.styles,"stylesheet")}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o="undefined"!=typeof window?window.JSZip:void 0!==n?n.JSZip:null,r=t("./util"),a=t("./common"),l=t("./relations"),u=t("./worksheet"),h=t("./XMLString");i.prototype={addWorksheet:function(t){if(t=s.defaults(t,{name:this.common.getNewWorksheetDefaultName()}),t.name.length>31)throw'Microsoft Excel requires work sheet names to be less than 32 characters long, work sheet name "'+t.name+'" is '+t.name.length+" characters long";var e=u(this.outerWorkbook,this.common,t),n=e.outerWorksheet,i=e.worksheet;return this.common.addWorksheet(i),this.relations.add(i,"worksheet"),n},save:function(t){var e=new o;return this.generateFiles(e),e.generateAsync(s.defaults(t,{compression:"DEFLATE",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",type:"base64"}))},saveAsNodeStream:function(t){var e=new o;return this.generateFiles(e),e.generateNodeStream(s.defaults(t,{compression:"DEFLATE"}))},generateFiles:function(t){this.prepareWorksheets(),this.saveWorksheets(t),this.saveTables(t),this.saveImages(t),this.saveDrawings(t),this.saveStyles(t),this.saveStrings(t),t.file("[Content_Types].xml",this.createContentTypes()),t.file("_rels/.rels",this.createWorkbookRelationship()),t.file("xl/workbook.xml",this.saveWorkbook()),t.file("xl/_rels/workbook.xml.rels",this.relations.save())},saveWorkbook:function(){return h({name:"workbook",ns:"spreadsheetml",attributes:[["xmlns:r",r.schemas.relationships]],children:[this.bookViewsXML(),this.sheetsXML(),this.definedNamesXML()]})},bookViewsXML:function(){return h({name:"bookViews",children:[h({name:"workbookView",attributes:[["activeTab",this.common.getActiveWorksheetIndex()]]})]})},sheetsXML:function(){var t=this,e=this.common.worksheets.map(function(e,n){return h({name:"sheet",attributes:[["name",e.name],["sheetId",n+1],["r:id",t.relations.getId(e)],["state",e.getState()]]})});return h({name:"sheets",children:e})},definedNamesXML:function(){if(this.common.worksheets.some(function(t){return t.isPrintTitle()})){var t=[];return this.common.worksheets.forEach(function(e,n){var i=e.savePrintTitle();i&&t.push(h({name:"definedName",value:i,attributes:[["name","_xlnm.Print_Titles"],["localSheetId",n]]}))}),h({name:"definedNames",children:t})}return""},prepareWorksheets:function(){this.common.worksheets.forEach(function(t){t.prepare()})},saveWorksheets:function(t){this.common.worksheets.forEach(function(e){t.file(e.path,e.save()),t.file(e.relationsPath,e.relations.save())})},saveTables:function(t){this.common.tables.forEach(function(e){t.file(e.path,e.save())})},saveImages:function(t){s.forEach(this.images.getImages(),function(e){t.file(e.path,e.data,{base64:!0,binary:!0}),e.data=null}),this.images.removeImages()},saveDrawings:function(t){this.common.drawings.forEach(function(e){t.file(e.path,e.save()),t.file(e.relationsPath,e.relations.save())})},saveStyles:function(t){t.file("xl/styles.xml",this.styles.save())},saveStrings:function(t){this.common.strings.isStrings()&&(this.relations.add(this.common.strings,"sharedStrings"),t.file("xl/sharedStrings.xml",this.common.strings.save()))},createContentTypes:function(){var t=[];return t.push(h({name:"Default",attributes:[["Extension","rels"],["ContentType","application/vnd.openxmlformats-package.relationships+xml"]]})),t.push(h({name:"Default",attributes:[["Extension","xml"],["ContentType","application/xml"]]})),t.push(h({name:"Override",attributes:[["PartName","/xl/workbook.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"]]})),this.common.strings.isStrings()&&t.push(h({name:"Override",attributes:[["PartName","/xl/sharedStrings.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"]]})),t.push(h({name:"Override",attributes:[["PartName","/xl/styles.xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"]]})),this.common.worksheets.forEach(function(e,n){t.push(h({name:"Override",attributes:[["PartName","/xl/worksheets/sheet"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]]}))}),this.common.tables.forEach(function(e,n){t.push(h({name:"Override",attributes:[["PartName","/xl/tables/table"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"]]}))}),s.forEach(this.common.images.getExtensions(),function(e,n){t.push(h({name:"Default",attributes:[["Extension",n],["ContentType",e]]}))}),this.common.drawings.forEach(function(e,n){t.push(h({name:"Override",attributes:[["PartName","/xl/drawings/drawing"+(n+1)+".xml"],["ContentType","application/vnd.openxmlformats-officedocument.drawing+xml"]]}))}),h({name:"Types",ns:"contentTypes",children:t})},createWorkbookRelationship:function(){return h({name:"Relationships",ns:"relationshipPackage",children:[h({name:"Relationship",attributes:[["Id","rId1"],["Type",r.schemas.officeDocument],["Target","xl/workbook.xml"]]})]})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./XMLString":2,"./common":4,"./relations":13,"./util":29,"./worksheet":33}],31:[function(t,e,n){(function(n){"use strict";function i(t,e){this.common=t,this.relations=e,this.drawings=null}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../drawings"),r=t("../XMLString");i.prototype={setImage:function(t,e){this.setDrawing(t,e,"anchor")},setImageOneCell:function(t,e){this.setDrawing(t,e,"oneCell")},setImageAbsolute:function(t,e){this.setDrawing(t,e,"absolute")},insert:function(t,e,n){if(n){var i={c:t+1,r:e+1};if("string"==typeof n||n.data)this.setDrawing(n,i,"anchor");else{var s=n.config||{};s.cell=i,this.setDrawing(n.image,s,"anchor")}}},setDrawing:function(t,e,n){this.drawings||(this.drawings=new o(this.common),this.common.addDrawings(this.drawings),this.relations.add(this.drawings,"drawingRelationship"));var i=s.isObject(t)?this.common.images.add(t.data,t.type):t;this.drawings.add(i,e,n)},save:function(){return this.drawings?r({name:"drawing",attributes:[["r:id",this.relations.getId(this.drawings)]]}):""}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../drawings":10}],32:[function(t,e,n){"use strict";function i(t,e){this.common=t,this.relations=e,this.hyperlinks=[]}var s=t("../util"),o=t("../XMLString");i.prototype={add:function(t){t.objectId=this.common.uniqueId("hyperlink"),this.relations.add({objectId:t.objectId,target:t.location,targetMode:t.targetMode||"External"},"hyperlink"),this.hyperlinks.push(t)},insert:function(t,e,n){if(n){var i={c:t+1,r:e+1};"string"==typeof n?this.add({cell:i,location:n}):this.add({cell:i,location:n.location,targetMode:n.targetMode,tooltip:n.tooltip})}},save:function(){var t=this;if(this.hyperlinks.length){var e=this.hyperlinks.map(function(e){var n=[["ref",s.canonCell(e.cell)],["r:id",t.relations.getId(e)]];return e.tooltip&&n.push(["tooltip",e.tooltip]),o({name:"hyperlink",attributes:n})});return o({name:"hyperlinks",children:e})}return""}},e.exports=i},{"../XMLString":2,"../util":29}],33:[function(t,e,n){"use strict";function i(t,e,n){var i={end:function(){return t},setActive:function(){return o.common.setActiveWorksheet(o),this},setVisible:function(){return this.setState("visible"),this},setHidden:function(){return this.setState("hidden"),this},setState:function(t){return o.setState(t),this},getState:function(){return o.getState()},setRows:function(t,e){return o.setRows(t,e),this},setRow:function(t,e){return o.setRow(t,e),this},setColumns:function(t,e){return o.setColumns(t,e),this},setColumn:function(t,e){return o.setColumn(t,e),this},setData:function(t,e){return o.setData(t,e),this},setAttribute:function(t,e){return o.sheetView.setAttribute(t,e),this},freeze:function(t,e,n,i){return o.sheetView.freeze(t,e,n,i),this},split:function(t,e,n,i){return o.sheetView.split(t,e,n,i),this},setHyperlink:function(t){return o.hyperlinks.add(t),this},mergeCells:function(t,e){return o.mergedCells.mergeCells(t,e),this},setImage:function(t,e){return o.drawings.setImage(t,e),this},setImageOneCell:function(t,e){return o.drawings.setImageOneCell(t,e),this},setImageAbsolute:function(t,e){return o.drawings.setImageAbsolute(t,e),this},addTable:function(t){return o.tables.add(t)},setHeader:function(t){return o.setHeader(t),this},setFooter:function(t){return o.setFooter(t),this},setPageMargin:function(t){return o.setPageMargin(t),this},setPageOrientation:function(t){return o.setPageOrientation(t),this},setPrintTitleTop:function(t){return o.setPrintTitleTop(t),this},setPrintTitleLeft:function(t){return o.setPrintTitleLeft(t),this},addSparklineType:function(t,e){return o.sparklines.addType(t,e)},setDefaultSparklineType:function(t){return o.sparklines.setDefaultType(t),this},addSparkline:function(t){return o.sparklines.add(t),this}},o=new s(i,e,n);return{outerWorksheet:i,worksheet:o}}var s=t("./worksheet");e.exports=i},{"./worksheet":41}],34:[function(t,e,n){(function(n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function s(t){this.worksheet=t,this.mergedCells=[]}var o="undefined"!=typeof window?window._:void 0!==n?n._:null,r=t("../util"),a=t("../XMLString");s.prototype={mergeCells:function(t,e){this.mergedCells.push([t,e])},insert:function(t,e,n,s,r,a){if(s&&(t=[].concat(i(t.slice(0,e+1)),i(o.times(s,function(){return{style:a,type:"empty"}})),i(t.slice(e+1)))),r){var l=this.worksheet.data;o.forEach(o.range(n+1,n+1+r),function(t){var n=l[t]||[];o.isArray(n)&&(n={data:n},l[t]=n),n.inserts=n.inserts||[],o.forEach(o.range(e,e+s+1),function(t){n.inserts[t]={style:a}})})}return t},save:function(){if(this.mergedCells.length){var t=this.mergedCells.map(function(t){return a({name:"mergeCell",attributes:[["ref",r.canonCell(t[0])+":"+r.canonCell(t[1])]]})});return a({name:"mergeCells",attributes:[["count",this.mergedCells.length]],children:t})}return""}},e.exports=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29}],35:[function(t,e,n){(function(t){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s="undefined"!=typeof window?window._:void 0!==t?t._:null,o={prepare:function(){this.tables.prepare(),this.prepareColumns(),this.prepareRows(),this.prepareData()},prepareColumns:function(){var t=this;this.preparedColumns=this.columns.map(function(e){if(e){var n=s.clone(e);if(e.style){var i=t.styles.addFormat(e.style);n.style=i;var o=t.styles.addFillOutFormat(i);n.selfStyleId=t.styles.getId(o)}return n}}),this.columns=null},prepareRows:function(){var t=this;this.preparedRows=this.rows.map(function(e){if(e){var n=s.clone(e);return e.style&&(n.style=t.styles.addFormat(e.style)),n}}),this.rows=null},prepareData:function(){this.maxX=0,this.preparedData=[];for(var t=0;t<this.data.length;t++){var e=this.prepareDataRow(t);this.preparedData.push(e),this.maxX=Math.max(this.maxX,e.length)}this.maxY=this.preparedData.length,this.data=null},prepareDataRow:function(t){var e=[],n=this.preparedRows[t],i=this.data[t];if(i){var o=null,r=!1,a=[];s.isArray(i)||(n=this.mergeDataRowToRow(n,i),i.inserts?(a=i.inserts,i=s.clone(i.data)):i=i.data),n&&(o=n.style||null,r=n.skipColumnsStyle),i=this.splitDataRow(n,i,t);for(var l=0,u=0;u<i.length||l<a.length;l++){var h=this.preparedColumns[l],f=!r&&h?h.style:null,d=void 0;a[l]?d={style:a[l].style,type:"empty"}:(d=i[u],u++);var c=this.readCellValue(d),m=c.cellValue,p=c.cellType,g=c.cellStyle,y=c.isObject,v=this.defineCellType(p,m,n,h),w=this.styles.getId(this.styles.merge(this.dataTimeStyle(v),f,o,g));y&&(this.hyperlinks.insert(l,t,d.hyperlink),this.drawings.insert(l,t,d.image),i=this.mergeCells(i,l,t,d)),e[l]=this.getPreparedCell(w,v,m)}}return n&&(this.setRowStyleId(n),this.preparedRows[t]=n),e},mergeDataRowToRow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];return t.height=e.height||t.height,t.outlineLevel=e.outlineLevel||t.outlineLevel,t.type=e.type||t.type,t.style=e.style?this.styles.addFormat(e.style):t.style,t.skipColumnsStyle=e.skipColumnsStyle||t.skipColumnsStyle,t},splitDataRow:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this,o=arguments[1],r=arguments[2],a=this.calcDataRowNestingCount(o);if(0===a)return o;var l=s.times(a,function(){var t=s.clone(e);return t.data=[],t});return s.forEach(o,function(t){var e=void 0,n=null;if(s.isArray(t)?e=t:s.isObject(t)&&!s.isDate(t)&&s.isArray(t.value)&&(e=t.value,n=t.style),e){s(e).initial().forEach(function(t,e){l[e].data.push({value:t,style:n})});var o={value:s.last(e),style:n},r=e.length,u=r<a?i.addRowspan(o,a-r+1):o;l[e.length-1].data.push(u)}else l[0].data.push(i.addRowspan(t,a))}),(t=this.data).splice.apply(t,[r,1].concat(n(l))),l[0].data},calcDataRowNestingCount:function(t){var e=0;return s.forEach(t,function(t){s.isArray(t)?e=Math.max(t.length,e):s.isObject(t)&&!s.isDate(t)&&s.isArray(t.value)&&(e=Math.max(t.value.length,e))}),e},addRowspan:function(t,e){return e>1?s.isObject(t)&&!s.isDate(t)?(t=s.clone(t),t.rowspan=e,t.style=this.styles.merge({vertical:"top"},t.style),t):{value:t,rowspan:e,style:{vertical:"top"}}:t},readCellValue:function(t){var e=void 0,n=null,o=null,r=!1;return s.isDate(t)?(e=t,n="dateOrTime"):t&&"object"===(void 0===t?"undefined":i(t))?(r=!0,t.style&&(o=t.style),t.formula?(e=t.formula,n="formula"):t.date?(e=t.date,n="date"):t.time?(e=t.time,n="time"):s.isDate(t.value)?(e=t.value,n="date"):(e=t.value,n=t.type)):e=t,{cellValue:e,cellType:n,cellStyle:o,isObject:r}},mergeCells:function(t,e,n,i){if(i.colspan||i.rowspan){var s=(i.colspan||1)-1,o=(i.rowspan||1)-1;if(s||o)return this.mergedCells.mergeCells({c:e+1,r:n+1},{c:e+1+s,r:n+1+o}),this.mergedCells.insert(t,e,n,s,o,i.style)}return t},defineCellType:function(t,e,n,i){if(t){if("dateOrTime"===t){var s=n&&n.type||i&&i.type;return"date"===s||"time"===s?s:"date"}return t}return n&&n.type?n.type:i&&i.type?i.type:"number"==typeof e?"number":"string"==typeof e?"string":void 0},dataTimeStyle:function(t){return"date"===t||"time"===t?t:null},getPreparedCell:function(t,e,n){var i={styleId:t,value:null,formula:null,isString:!1};if("string"===e)i.value=this.common.strings.add(n),i.isString=!0;else if("date"===e||"time"===e){var o=s.isDate(n)?n.valueOf():n,r=25569+(o-this.timezoneOffset)/864e5;s.isFinite(r)?i.value=r:(i.value=this.common.strings.add(String(n)),i.isString=!0)}else"formula"===e?i.formula=s.escape(n):i.value=n;return i},setRowStyleId:function(t){if(t.style){var e=this.styles.addFillOutFormat(t.style);t.selfStyleId=this.styles.getId(e)}}};e.exports={methods:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(t,e,n){(function(n){"use strict";function i(t){return["&L",s(t[0]||""),"&C",s(t[1]||""),"&R",s(t[2]||"")].join("")}function s(t){if(o.isString(t))return'&"-,Regular"'+t;if(o.isObject(t)&&!o.isArray(t)){var e='&"'+(t.font||"-")+",";return t.bold&&t.italic?e+="Bold Italic":t.bold?e+="Bold":t.italic?e+="Italic":e+="Regular",e+='"',t.underline&&(e+="&U"),t.fontSize&&(e+="&"+t.fontSize),e+=t.text}return o.isArray(t)?o.reduce(t,function(t,e){return t+s(e)},""):void 0}var o="undefined"!=typeof window?window._:void 0!==n?n._:null,r=t("../util"),a=t("../XMLString"),l={setHeader:function(t){if(!o.isArray(t))throw"Invalid argument type - setHeader expects an array of three instructions";this.headers=t},setFooter:function(t){if(!o.isArray(t))throw"Invalid argument type - setFooter expects an array of three instructions";this.footers=t},setPageMargin:function(t){this.margin=o.defaults(t,{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3})},setPageOrientation:function(t){"portrait"!==t&&"landscape"!==t||(this.orientation=t)},setPrintTitleTop:function(t){this.printTitles=this.printTitles||{},o.isObject(t)?(this.printTitles.topFrom=t[0],this.printTitles.topTo=t[1]):(this.printTitles.topFrom=0,this.printTitles.topTo=t-1)},setPrintTitleLeft:function(t){this.printTitles=this.printTitles||{},o.isObject(t)?(this.printTitles.leftFrom=t[0],this.printTitles.leftTo=t[1]):(this.printTitles.leftFrom=0,this.printTitles.leftTo=t-1)},isPrintTitle:function(){return this.printTitles&&(this.printTitles.topTo>=0||this.printTitles.leftTo>=0)},savePrintTitle:function(){if(this.isPrintTitle()){var t=this.printTitles,e="";return t.topTo>=0&&(e=this.sheetName()+"!$"+(t.topFrom+1)+":$"+(t.topTo+1),t.leftTo>=0&&(e+=",")),t.leftTo>=0&&(e+=this.sheetName()+"!$"+r.positionToLetter(t.leftFrom+1)+":$"+r.positionToLetter(t.leftTo+1)),e}return""},savePrint:function(){return this.savePageMargins()+this.savePageSetup()+this.saveHeaderFooter()},savePageMargins:function(){var t=this.margin;return t?a({name:"pageMargins",attributes:[["top",t.top],["bottom",t.bottom],["left",t.left],["right",t.right],["header",t.header],["footer",t.footer]]}):""},savePageSetup:function(){return this.orientation?a({name:"pageSetup",attributes:[["orientation",this.orientation]]}):""},saveHeaderFooter:function(){if(this.headers.length||this.footers.length){var t=[];return this.headers.length&&t.push(this.saveHeader()),this.footers.length&&t.push(this.saveFooter()),a({name:"headerFooter",children:t})}return""},saveHeader:function(){return a({name:"oddHeader",value:i(this.headers)})},saveFooter:function(){return a({name:"oddFooter",value:i(this.footers)})}};e.exports={methods:l}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29}],37:[function(t,e,n){(function(n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function r(t){return y.xmlPrefix+'<worksheet xmlns="'+y.schemas.spreadsheetml+'" xmlns:r="'+y.schemas.relationships+'" xmlns:mc="'+y.schemas.markupCompat+'">'+f(t.maxX,t.maxY)+t.sheetView.save()+d(t.preparedColumns)+"<sheetData>"}function a(t){return"</sheetData>"+t.mergedCells.save()+t.hyperlinks.save()+t.savePrint()+t.tables.save()+t.drawings.save()+c(t.sparklines)+"</worksheet>"}function l(t){for(var e=t.preparedData,n=t.preparedRows,i="",s=0,o=e.length;s<o;s++)i+=u(e[s],n[s],s),e[s]=null;return i}function u(t,e,n){if(t){for(var i=t.length,s=new Array(i),o=0;o<i;o++){var r=t[o];if(r){var a=' r="'+y.positionToLetter(o+1,n+1)+'"';r.styleId&&(a+=' s="'+r.styleId+'"'),r.isString&&(a+=' t="s"'),g.isNil(r.value)?g.isNil(r.formula)?s[o]="<c"+a+"/>":s[o]="<c"+a+"><f>"+r.formula+"</f></c>":s[o]="<c"+a+"><v>"+r.value+"</v></c>"}}return"<row"+h(e,n)+">"+s.join("")+"</row>"}return"<row"+h(e,n)+"></row>"}function h(t,e){var n=' r="'+(e+1)+'"';return t&&(void 0!==t.height&&(n+=' customHeight="1" ht="'+t.height+'"'),t.selfStyleId&&(n+=' customFormat="1" s="'+t.selfStyleId+'"'),t.outlineLevel&&(n+=' outlineLevel="'+t.outlineLevel+'"')),n}function f(t,e){var n=[];return 0!==t?n.push(["ref","A1:"+y.positionToLetter(t,e)]):n.push(["ref","A1"]),v({name:"dimension",attributes:n})}function d(t){if(t.length){var e=t.map(function(t,e){t=t||{};var n=[["min",t.min||e+1],["max",t.max||e+1]];return t.hidden&&n.push(["hidden",1]),t.bestFit&&n.push(["bestFit",1]),t.width?(n.push(["customWidth",1]),n.push(["width",t.width])):n.push(["width",9.140625]),t.selfStyleId&&n.push(["style",t.selfStyleId]),v({name:"col",attributes:n})});return v({name:"cols",children:e})}return""}function c(t){var e=t.save();return e?v({name:"extLst",children:[e]}):""}var m=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),p=t("stream").Readable,g="undefined"!=typeof window?window._:void 0!==n?n._:null,y=t("../util"),v=t("../XMLString"),w={save:function(){return!p?r(this)+l(this)+a(this):new b({worksheet:this})}},b=function(t){function e(t){i(this,e);var n=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.worksheet=t.worksheet,n.status=0,n.index=0,n.len=n.worksheet.preparedData.length,n}return o(e,t),m(e,[{key:"_read",value:function(t){var e=!1;if(0===this.status&&(e=!this.push(r(this.worksheet)),this.status=1),1===this.status){for(;this.index<this.len&&!e;)e=!this.push(this.packChunk(t));this.index===this.len&&(this.status=2)}2===this.status&&(this.push(a(this.worksheet)),this.push(null))}},{key:"packChunk",value:function(t){for(var e=this.worksheet,n=e.preparedData,i=e.preparedRows,s="";this.index<this.len&&s.length<t;)s+=u(n[this.index],i[this.index],this.index),n[this.index]=null,this.index++;return s}}]),e}(p||null);e.exports={methods:w}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29,stream:1}],38:[function(t,e,n){(function(n){"use strict";function i(t){var e=this;this.pane=null,this.attributes={defaultGridColor:{value:null,bool:!0},colorId:{value:null},rightToLeft:{value:null,bool:!0},showFormulas:{value:null,bool:!0},showGridLines:{value:null,bool:!0},showOutlineSymbols:{value:null,bool:!0},showRowColHeaders:{value:null,bool:!0},showRuler:{value:null,bool:!0},showWhiteSpace:{value:null,bool:!0},showZeros:{value:null,bool:!0},tabSelected:{value:null,bool:!0},topLeftCell:{value:null},view:{value:"normal"},windowProtection:{value:null,bool:!0},zoomScale:{value:null},zoomScaleNormal:{value:null},zoomScalePageLayoutView:{value:null},zoomScaleSheetLayoutView:{value:null}},s.forEach(t,function(t,n){"freeze"===n?e.freeze(t.col,t.row,t.cell,t.activePane):"split"===n?e.split(t.x,t.y,t.cell,t.activePane):e.attributes[n]&&(e.attributes[n].value=t)})}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../util"),r=t("../XMLString");i.prototype={setAttribute:function(t,e){this.attributes[t]&&(this.attributes[t].value=e)},freeze:function(t,e,n,i){this.pane={state:"frozen",xSplit:t,ySplit:e,topLeftCell:o.canonCell(n)||o.positionToLetter(t+1,e+1),activePane:i||"bottomRight"}},split:function(t,e,n,i){this.pane={state:"split",xSplit:20*t,ySplit:20*e,topLeftCell:o.canonCell(n)||"A1",activePane:i||"bottomRight"}},save:function(){var t=[["workbookViewId",0]];return s.forEach(this.attributes,function(e,n){var i=e.value;null!==i&&(e.bool&&(i=i?"true":"false"),t.push([n,i]))}),r({name:"sheetViews",children:[r({name:"sheetView",attributes:t,children:[this.savePane()]})]})},savePane:function(){var t=this.pane;return t?r({name:"pane",attributes:[["state",t.state],["xSplit",t.xSplit],["ySplit",t.ySplit],["topLeftCell",t.topLeftCell],["activePane",t.activePane]]}):""}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29}],39:[function(t,e,n){(function(n){"use strict";function i(t){this.worksheet=t,this.lines=Object.create(null),this.defaultLines={type:null,lines:[]},this.typesByData=Object.create(null),this.lastId=1}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("../util"),r=t("../XMLString"),a={displayEmptyCellsAs:"gap"},l={color:"FF376092",colorNegative:"FFD00000",colorAxis:"FF000000",colorMarkers:"FFD00000",colorFirst:"FFD00000",colorLast:"FFD00000",colorHigh:"FFD00000",colorLow:"FFD00000"};i.prototype={addType:function(t,e){var n=this.canonType(t),i=JSON.stringify(n);return!e&&this.typesByData[i]?this.typesByData[i]:this.addNew(n,i,e)},setDefaultType:function(t){this.defaultLines.type=this.canonType(t)},add:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.cell,n=t.beginCell,i=t.endCell,s=t.type,r={cell:o.canonCell(e),beginCell:o.canonCell(n),endCell:o.canonCell(i)};s?this.lines(s).lines.push(r):this.defaultLines.lines.push(r)},insert:function(){},canonType:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};return s.keys(a).forEach(function(n){e[n]=t[n]||a[n]}),s.keys(l).forEach(function(n){e[n]=o.canonColor(t[n]||l[n])}),e},addNew:function(t,e,n){return n=n||"Sparklines"+this.lastId++,this.typesByData[e]=n,this.lines(t).type=t,n},lines:function(t){return this.lines[t]=this.lines[t]||{type:null,lines:[]},this.lines[t]},save:function(){var t=this,e=[]
;if(this.defaultLines.lines.length){var n=this.defaultLines.type||this.canonType();e.push(this.saveType(n,this.defaultLines.lines))}return s.forEach(this.lines,function(n){var i=n.type,s=n.lines;i&&s.length&&e.push(t.saveType(i,s))}),e.length?r({name:"ext",attributes:[["uri","{05C60535-1F16-4fd2-B633-F4F36F0B64E0}"],["xmlns:x14","http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"]],children:[r({name:"x14:sparklineGroups",attributes:[["xmlns:xm","http://schemas.microsoft.com/office/excel/2006/main"]],children:e})]}):""},saveType:function(t,e){var n=[],i=[];return s.keys(a).forEach(function(e){n.push([e,t[e]])}),s.keys(l).forEach(function(e){var n="color"===e?"colorSeries":e,s=t[e];i.push("<x14:"+n+' rgb="'+s+'"/>')}),i.push(r({name:"x14:sparklines",children:this.saveLines(e)})),r({name:"x14:sparklineGroup",attributes:n,children:i})},saveLines:function(t){var e=this;return t.map(function(t){return r({name:"x14:sparkline",children:["<xm:f>"+e.worksheet.sheetName()+"!"+t.beginCell+":"+t.endCell+"</xm:f>","<xm:sqref>"+t.cell+"</xm:sqref>"]})})}},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../XMLString":2,"../util":29}],40:[function(t,e,n){"use strict";function i(t,e,n){this.worksheet=t,this.common=e,this.relations=n,this.tables=[]}var s=t("../table"),o=t("../XMLString");i.prototype={add:function(t){var e=s(this.worksheet.outerWorksheet,this.common,t),n=e.outerTable,i=e.table;return this.common.addTable(i),this.relations.add(i,"table"),this.tables.push(i),n},prepare:function(){var t=this;this.tables.forEach(function(e){e.prepare(t.worksheet.data)})},save:function(){var t=this;if(this.tables.length){var e=this.tables.map(function(e){return o({name:"tablePart",attributes:[["r:id",t.relations.getId(e)]]})});return o({name:"tableParts",attributes:[["count",this.tables.length]],children:e})}return""}},e.exports=i},{"../XMLString":2,"../table":27}],41:[function(t,e,n){(function(n){"use strict";function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.outerWorksheet=t,this.common=e,this.styles=this.common.styles,this.objectId=this.common.uniqueId("Worksheet"),this.data=[],this.columns=[],this.rows=[],this.headers=[],this.footers=[],this.name=n.name,this.state=n.state||"visible",this.timezoneOffset=60*(new Date).getTimezoneOffset()*1e3,this.relations=new m(this.common),this.tables=new o(this,this.common,this.relations),this.drawings=new r(this.common,this.relations),this.hyperlinks=new a(this.common,this.relations),this.mergedCells=new l(this),this.sparklines=new u(this),this.sheetView=new h(n)}var s="undefined"!=typeof window?window._:void 0!==n?n._:null,o=t("./tables"),r=t("./drawing"),a=t("./hyperlinks"),l=t("./mergedCells"),u=t("./sparklines"),h=t("./sheetView"),f=t("./print"),d=t("./prepareSave"),c=t("./save"),m=t("../relations");i.prototype=s.assign({setRows:function(t,e){var n=this;e?--t:(e=t,t=0),e.forEach(function(e,i){n.rows[t+i]=e})},setRow:function(t,e){this.rows[--t]=e},setColumns:function(t,e){var n=this;e?--t:(e=t,t=0),e.forEach(function(e,i){n.columns[t+i]=e})},setColumn:function(t,e){this.columns[--t]=e},setData:function(t,e){var n=this,i=this.data.length;e?i+=t:e=t,e.forEach(function(t,e){n.data[i+e]=t})},setState:function(t){this.state=t},getState:function(){return this.state},sheetName:function(){return"'"+this.name+"'"}},f.methods,d.methods,c.methods),e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../relations":13,"./drawing":31,"./hyperlinks":32,"./mergedCells":34,"./prepareSave":35,"./print":36,"./save":37,"./sheetView":38,"./sparklines":39,"./tables":40}]},{},[12])(12)});